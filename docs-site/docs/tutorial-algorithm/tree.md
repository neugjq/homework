---
sidebar_position: 6
---
# Tree & Spanning Tree 树与生成树算子集

**算子类别**：Tree & Spanning Tree（最小/最大/随机生成树）  
**描述**：面向无向图的生成树相关算法，用于构建“覆盖所有节点且无环”的骨架结构，并在不同目标（最小成本 / 最大收益 / 随机采样）下输出生成树或生成森林。

---

## 一、算子集概述

在图分析与网络工程里，经常需要把复杂网络“抽骨架”：

- **最小生成树（MST）**：在保证连通覆盖的前提下，使总成本/距离/时延最小。
- **最大生成树（MaxST）**：在保证连通覆盖的前提下，使总收益/带宽/相似度最大。
- **随机生成树（Random ST）**：按权重定义的分布随机采样生成树，用于仿真、压力测试、随机化策略或生成式内容（如迷宫）。

> 说明：当输入图 `G` **不连通** 时，NetworkX 会返回 **生成森林（spanning forest）**，即每个连通分量各自一棵树。

---

## 二、算子列表

- `minimum_spanning_tree`
- `maximum_spanning_tree`
- `random_spanning_tree`

---

## 三、通用输入输出约定

### 3.1 输入（Input）

- **G**：无向图（undirected graph），支持 `multigraph`（多重边）。  
- **weight**：边权属性名（默认 `"weight"`，随机生成树可为 `None` 表示无权/等权）。

### 3.2 输出（Output）

- **minimum_spanning_tree / maximum_spanning_tree**：`NetworkX Graph`（生成树或生成森林）
- **random_spanning_tree**：`nx.Graph`（按权重分布采样到的一棵生成树）

---

## 四、算子详细说明

## 4.1 minimum_spanning_tree —— 最小生成树（MST）

### 功能说明
在无向加权图中选择一组边，使得：
1) 覆盖所有节点（连通时为树，不连通时为森林）；  
2) 不包含环；  
3) **总边权之和最小**。

### 适用场景（Application scenario）
- 网络设计：以最低建设成本/最短线缆长度连接所有站点（光纤铺设、供水管网、配电线缆）。
- 线路规划：以最低总时延/最短总距离形成覆盖骨架。
- 资源最省的“全覆盖连接方案”。

### 参数与调优（Tuning Mechanisms）
- **weight (str)**：指定使用哪一个边属性作为权重（如 `cost` / `distance` / `latency`）。  
  - 改它会改变“最小”的评价口径，从而改变输出树结构。
- **algorithm (str)**：`'kruskal' | 'prim' | 'boruvka'`（默认 `kruskal`）  
  - **Kruskal**：按边权排序逐步选边，适合稀疏图；  
  - **Prim**：从某点扩展，适合连通图与邻接结构；  
  - **Boruvka**：并行式合并组件，某些大图/工程实现中常用。
- **ignore_nan (bool)**：遇到 NaN 权重时的处理  
  - `False`：默认抛异常  
  - `True`：忽略该边（相当于不可用）

### 原理（Principles）
算法通过不断挑选“不会成环且尽量便宜”的边把多个连通块合并，直到覆盖全部节点。  
**典型复杂度**：`O(E log V)`（Kruskal/Prim 常见实现）

### 可回答问题（solvable_questions）
- 计算该加权无向图的 MST，输出总权重与所有边。
- 输出 MST 的完整边表，并按权重从小到大排序。
- 城市供水/园区光纤/物流骨架：如何以最低总成本覆盖全部节点？

---

## 4.2 maximum_spanning_tree —— 最大生成树（MaxST）

### 功能说明
与 MST 相反：在无向加权图中选择一组边，使得覆盖所有节点且无环，并且 **总边权之和最大**。

### 适用场景（Application scenario）
- 通信/骨干网络：边权表示带宽或吞吐，目标是最大化总体容量骨架。
- 相关性/相似度网络：边权是相似度，输出“最大相似度骨架”（常用于可视化与结构抽取）。
- 信任/影响传播：边权表示信任强度，抽取最大可信传播骨架。

### 参数与调优（Tuning Mechanisms）
- **weight (str)**：边权属性名（默认 `"weight"`），决定“最大化”的指标口径。
- **algorithm (str)**：`'kruskal' | 'prim' | 'boruvka'`（默认 `kruskal`）  
  不同算法主要影响性能与实现路径，结果应在同权重定义下等价（可能因同权边导致多解）。
- **ignore_nan (bool)**：是否忽略 NaN 权重边（同 MST 逻辑）。

### 原理（Principles）
本质上是对“最大化”目标的生成树构造，可视为把边权取负后做 MST，或直接使用对应最大生成树版本。  
**典型复杂度**：`O(E log V)`。

### 可回答问题（solvable_questions）
- 计算 MaxST，输出所有边与权重。
- 在“带宽/信任/相似度”网络中，选择哪些边组成最大化骨架？
- 输出 MaxST 的连接关系矩阵，按边权从大到小排序。

---

## 4.3 random_spanning_tree —— 随机生成树采样

### 功能说明
从给定无向（可加权）图中，按指定的概率分布 **随机采样** 一棵生成树。

- 当指定 `weight` 时，生成树的概率与边权相关；
- 适用于生成式结构、仿真测试、随机化策略、避免固定模式等。

### 适用场景（Application scenario）
- 迷宫/地图生成：生成“无环、全连通”的随机通路骨架。
- 网络压力测试：从真实拓扑中随机抽取临时骨干结构。
- 韧性仿真：随机采样多棵备选骨架，评估关键边出现频率。

### 参数与调优（Tuning Mechanisms）
- **weight (str | None)**：用于决定采样分布的边权属性  
  - `None`：等权采样（更接近均匀随机生成树）
- **multiplicative (bool, default=True)**：概率计算方式  
  - `True`：树概率与“边权乘积”成比例（偏向每条边都强的树）  
  - `False`：树概率与“边权求和”成比例（偏向整体更大但允许局部弱边）
- **seed**：随机种子，用于可复现性

### 原理（Principles）
核心思想是基于随机过程（NetworkX 实现通常与 Wilson’s algorithm 等随机游走/生成树采样思想相关）按分布采样生成树。  
**复杂度**：多项式时间（Polynomial，具体随实现与图规模变化）。

### 可回答问题（solvable_questions）
- 随机生成一棵生成树并输出边列表。
- 随机采样 5 棵不同的生成树，分别输出连接关系。
- 迷宫设计：随机生成连接所有房间且不成环的通路结构。
- 为避免被识别固定模式，生成随机的备选连接骨架。

---

## 五、选型指南（快速怎么选）

- **目标是最低成本/最短距离/最小延迟**：用 `minimum_spanning_tree`
- **目标是最大带宽/最大信任/最大相似度骨架**：用 `maximum_spanning_tree`
- **目标是随机化、仿真、采样、多方案备选**：用 `random_spanning_tree`
- **输入图可能不连通**：三者都将输出 **生成森林**（每个连通分量一棵树）

---

## 六、实践建议（常见坑位）

1. **边权口径要对齐**：  
   - 成本类用 MST；收益/强度类用 MaxST；别把含义搞反。
2. **多重边（multigraph）注意 key**：  
   - NetworkX 会在多重边情况下保留多条候选边，结果可能选中不同 key 的边。
3. **NaN 权重要提前处理或开启 ignore_nan**：  
   - 否则 MST/MaxST 可能直接报错。
4. **同权重导致多解**：  
   - 生成树并不唯一，尤其当权重重复很多时，不同算法或遍历顺序可能给出不同但等价的树。

---
